<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ASP.NET API Service Generator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f7f7f7; }
    .container { max-width: 600px; background: #fff; padding: 15px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.2); }
    .field { display: flex; align-items: center; margin: 8px 0; gap: 10px; flex-wrap: wrap; }
    .field label { font-weight: bold; flex: 0 0 200px; font-size: 14px; }
    input, button, textarea { padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; }
    input, textarea { flex: 1; min-width: 200px; }
    button { margin-top: 15px; padding: 10px 20px; cursor: pointer; background: #007bff; color: white; border: none; }
    button:hover { background: #0056b3; }
    textarea { width: 100%; height: 500px; margin-top: 20px; font: 13px Consolas, monospace; resize: vertical; }
  </style>
</head>
<body>
  <div class="container">
    <h2>ASP.NET API Service Generator</h2>

    <div class="field"><label>Namespace Name:</label><input type="text" id="namespace" placeholder="e.g. MyApp.Services"></div>
    <div class="field"><label>Service Name:</label><input type="text" id="service" placeholder="e.g. ProjectService"></div>
    <div class="field"><label>Repository Name:</label><input type="text" id="repository" placeholder="e.g. IProjectRepository"></div>
    <div class="field"><label>DTO Name:</label><input type="text" id="dto" placeholder="e.g. ProjectDTO"></div>
    <div class="field"><label>Is Asynchronous:</label><input type="checkbox" id="isAsync" checked></div>
    <div class="field"><label>Wrap Try-Catch:</label><input type="checkbox" id="wrapTryCatch" checked></div>

    <div class="field"><label>Create Method Name:</label><input type="text" id="createMethod" placeholder="e.g. AddAsync"></div>
    <div class="field"><label>Read (All) Method Name:</label><input type="text" id="readAllMethod" placeholder="e.g. GetAllAsync"></div>
    <div class="field"><label>Read (One) Method Name:</label><input type="text" id="readOneMethod" placeholder="e.g. GetByIdAsync"></div>
    <div class="field"><label>Update Method Name:</label><input type="text" id="updateMethod" placeholder="e.g. UpdateAsync"></div>
    <div class="field"><label>Delete Method Name:</label><input type="text" id="deleteMethod" placeholder="e.g. DeleteAsync"></div>

    <button onclick="generateService()">Generate Service</button>
    <textarea id="output" placeholder="Generated service code will appear here..." readonly></textarea>
  </div>

  <script>
    function toCamelCase(name) {
      if (!name) return "";
      return name.charAt(0).toLowerCase() + name.slice(1);
    }

    function generateService() {
      const ns = document.getElementById('namespace').value.trim() || "DemoNamespace";
      const service = document.getElementById('service').value.trim() || "DemoService";
      const repository = document.getElementById('repository').value.trim() || "DemoRepository";
      const dto = document.getElementById('dto').value.trim() || (service.replace("Service","") + "DTO");

      const isAsync = document.getElementById('isAsync').checked;
      const wrapTryCatch = document.getElementById('wrapTryCatch').checked;

      const createMethod = document.getElementById('createMethod').value.trim() || "AddAsync";
      const readAllMethod = document.getElementById('readAllMethod').value.trim() || "GetListAsync";
      const readOneMethod = document.getElementById('readOneMethod').value.trim() || "GetByIdAsync";
      const updateMethod = document.getElementById('updateMethod').value.trim() || "UpdateAsync";
      const deleteMethod = document.getElementById('deleteMethod').value.trim() || "DeleteAsync";

      let repoVar = "_" + toCamelCase(repository.replace(/^I/, "")); // e.g. IProjectRepository -> _projectRepository

      let code = `using System;\nusing System.Collections.Generic;\nusing System.Threading.Tasks;\n\n`;
      code += `namespace ${ns}\n{\n`;
      code += `    public class ${service}\n    {\n`;
      code += `        private readonly ${repository} ${repoVar};\n\n`;
      code += `        public ${service}(${repository} ${repoVar.replace("_", "")})\n        {\n`;
      code += `            ${repoVar} = ${repoVar.replace("_", "")};\n        }\n\n`;

      function addMethod(returnType, name, paramType, paramName, bodyCall) {
        code += `        public ${isAsync ? "async Task<" + returnType + ">" : returnType} ${name}(${paramType ? paramType+" "+paramName : ""})\n        {\n`;
        if (wrapTryCatch) code += `            try\n            {\n`;
        code += `                ${isAsync ? "return await" : "return"} ${repoVar}.${bodyCall};\n`;
        if (wrapTryCatch) {
          code += `            }\n            catch (Exception ex)\n            {\n`;
          code += `                throw ex;\n`;
          code += `            }\n`;
        }
        code += `        }\n\n`;
      }

      addMethod(dto, createMethod, dto, "dto", createMethod + "(dto)");
      addMethod(`List<${dto}>`, readAllMethod, "", "", readAllMethod + "()");
      addMethod(dto+"?", readOneMethod, "long", "id", readOneMethod + "(id)");
      addMethod(dto, updateMethod, dto, "dto", updateMethod + "(dto)");
      addMethod("bool", deleteMethod, "long", "id", deleteMethod + "(id)");

      code += `    }\n}`;
      document.getElementById('output').value = code;
    }
  </script>
</body>
</html>
